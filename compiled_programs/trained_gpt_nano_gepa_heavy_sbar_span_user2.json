{
  "traces": [],
  "train": [],
  "demos": [],
  "signature": {
    "instructions": "text\nTask: Extract SBAR quotes (Situation, Background, Assessment, Recommendation) from a clinical handover-style transcript with speaker tags.\n\nINPUT\n- One variable: `text`\n- `text` is a single transcript containing speaker tags like: [OUTGOING_NURSE], [INCOMING_NURSE], [NURSE], [DOCTOR], [PHARMACIST], [PATIENT], etc.\n- Content may be bedside handover, escalation to doctor, discharge planning, cath lab → CCU transfer, etc.\n\nOUTPUT (STRICT)\n- Output ONLY an ordered JSON-like list of dictionaries (no prose, no code fences), in the exact order the quoted spans appear in `text`:\n\n[\n  {\"label\": \"SITUATION\"|\"BACKGROUND\"|\"ASSESSMENT\"|\"RECOMMENDATION\",\n   \"quote\": \"<EXACT VERBATIM CONTIGUOUS SPAN FROM TRANSCRIPT>\"}\n]\n\nABSOLUTE RULES (SCORING-CRITICAL)\n1) Verbatim + contiguous substrings only\n- Every `quote` must be copied character-for-character from `text` (including typos, casing, odd spacing, punctuation, units, symbols like “SpO?:”, “°C”, en-dashes, and line breaks).\n- Each quote must be ONE continuous substring from ONE location in `text`.\n- Never stitch together non-adjacent parts and never omit words inside a quote.\n- Do NOT include speaker tags (e.g., “[NURSE]:”) in the quote.\n\n2) Tight boundaries (IoU optimized)\n- Start/end exactly around the SBAR-relevant clinical content; trim framing.\n- Exclude unless they are the only carrier of clinical meaning:\n  - greetings/thanks/introductions\n  - consent-to-handover (“is that okay?”)\n  - identity checks (name/DOB/ID band)\n  - “I’m handing over…”\n  - bed numbers, age, “under Dr X”, and other admin.\n- Prefer the longest self-contained span that contains ONLY ONE SBAR label.\n- If a single turn includes multiple SBAR types, split at the exact boundary where the label changes.\n\n3) Don’t miss short embedded fragments (gold prefers many small spans)\nExtract short but meaningful items even if brief:\n- stability: “currently stable”, “observations stable”\n- symptom positives/negatives: “No chest pain”, “more confused than baseline”\n- allergies as their own short BACKGROUND span: “No known drug allergies.” / “penicillin allergy—…”\n- lines/access/infusions when stated as current (often ASSESSMENT): cannula status, IABP, CVL, telemetry, heparin infusion, noradrenaline dose\n- investigation/result snippets: ECG normal, checklist completed, vitals block, Q-ADDS score, bloods (WCC/CRP/Cr), fluid balance, urine output, CXR/TTE booked\n- pathway status: booked/awaiting procedure, transfer status\n\n4) Combine vs split (gold often splits)\nCombine adjacent sentences into ONE quote only if:\n- they are directly adjacent in `text`, AND\n- they are the same SBAR label, AND\n- they read as one coherent block with no label shift.\nOtherwise split—especially at common shifts:\n- reason/admission/procedure context → current findings\n- current findings/vitals/results → actions/instructions/escalation\n- “booked/awaiting procedure/investigation” (SITUATION) → “keep fasted / monitor / call if…” (RECOMMENDATION)\n\n5) Questions vs answers\n- Do NOT extract staff questions as ASSESSMENT/RECOMMENDATION.\n- Extract the declarative answer statements that contain findings/plan.\n- Patient subjective symptoms count as ASSESSMENT if describing current condition.\n\nSBAR LABEL DEFINITIONS (match gold tendencies from feedback)\nSITUATION (why here / immediate pathway status)\n- Presenting problem/diagnosis/reason for admission (“admitted with UTI…”, “anterior STEMI…”, “being discharged today”).\n- “for/awaiting/booked for” a procedure/investigation/transfer when describing what’s happening now.\n- If a sentence mixes reason + stability/findings, split: reason/procedure context = SITUATION; stability/findings = ASSESSMENT.\n\nBACKGROUND (past context / baseline risks / long-term meds / allergies)\n- PMHx, baseline function, prior context.\n- Long-term/home/discharge medication lists belong here (e.g., “Metoprolol… Atorvastatin…”).\n- Allergies are BACKGROUND and should often be their own tiny span.\n- Communication/language background can be BACKGROUND if it’s purely context (e.g., non-English speaking background).\n\nASSESSMENT (current condition/findings/status/results)\n- Current observations/vitals, Q-ADDS, mental state, pain/symptoms, physical findings.\n- Current lines/access/attachments/infusions status is typically ASSESSMENT (IMPORTANT: do NOT mislabel as BACKGROUND when it’s current, e.g., “IV heparin infusion”, “no current vascular access”).\n- Current fasting status as a state (“Fasted from midnight…”) is ASSESSMENT.\n- “Pre-op checklist completed”, “ECG done and normal”, “tolerating IABP well” are ASSESSMENT.\n\nRECOMMENDATION (what to do next / plan / tasks / escalation)\n- Any instruction or future/ongoing action: insert cannula, order lactate, start antibiotics, arrange INR monitoring, notify GP, provide education leaflet, send warfarin pack, monitor closely, consider transfer, “call if worsens”.\n- “Booked for X-ray/echo” and “team will review later” are typically RECOMMENDATION/plan (even if already arranged).\n- Social work/interpreter “requested” is usually RECOMMENDATION (action/plan), not BACKGROUND.\n- Incoming clinician “I’ll …” statements are RECOMMENDATION.\n\nKNOWN GOLD-ALIGNMENT PITFALLS TO AVOID (seen in feedback)\n- Do not create extra spans for dose-history that gold may treat as part of assessment/plan; prioritize current-status + plan statements.\n- Keep “counselling/education provided” as RECOMMENDATION/plan if it’s framed as discharge planning actions; don’t label it ASSESSMENT.\n- In cath lab example, “two stents placed…” is often part of SITUATION/procedure context rather than BACKGROUND; avoid isolating it as BACKGROUND unless clearly framed as prior history.\n- Ensure you extract late small spans like “Let me know if anything changes.” (RECOMMENDATION) and “All documentation is up to date.” (ASSESSMENT) when present.\n\nPROCESS (do this every time)\n1) Read `text` top-to-bottom.\n2) Identify every SBAR-relevant fragment (including very short ones).\n3) For each fragment, select the tightest contiguous substring that covers only that label.\n4) Split aggressively when the label changes; combine only when clearly same-label and cohesive.\n5) Output the ordered list of {label, quote} with exact verbatim text and no duplicates and no extra surrounding commentary.",
    "fields": [
      {
        "prefix": "Text:",
        "description": "${text}"
      },
      {
        "prefix": "Pred Spans:",
        "description": "${pred_spans}"
      }
    ]
  },
  "lm": null,
  "metadata": {
    "dependency_versions": {
      "python": "3.12",
      "dspy": "3.0.4",
      "cloudpickle": "3.1"
    }
  }
}
